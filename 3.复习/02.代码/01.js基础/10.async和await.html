<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        /*
            async和await
                async和await是回调地狱的终极解决方案
                    他们以同步的流程,书写异步的代码
                他们其实是Promise和.then的语法糖
                async关键字使用在函数声明之前
                    async function a(){

                    }
                    async ()=>{}

                await右边可以写promise的表达式,并且可以获取到右侧promise对象的result值作为await表达式的结果
                    await右侧如果书写的是非Promise对象,那么await表达式的返回值就是右侧的数据
                await之后的代码会被进阻塞

                注意点:
                    1.无论await右侧的promise是否是立即成功,await之后的代码都一定会异步执行
                        await之后的代码,都会被放入.then的成功回调函数中
                    2.async函数的返回值一定是一个promise对象(简称为p3对象)
                        如果在async函数中书写return数据,那么该数据会成为p3对象的result值

                        如何控制p3的状态变化
                            变为成功
                                1.只要async函数中的代码成功执行结束,返回的p3就会变为成功状态

                                2.如果回调函数中返回一个成功状态的promise对象,那么返回的p3也会变为成功状态

                            变为失败
                                3.只要async函数中的代码出现报错,返回的p3就会变为失败状态

                                4.如果回调函数中返回一个失败状态的promise对象,那么返回的p3也会变为失败状态

        */

        async function a(){
            console.log(1)
            // const result = await 100;

            const result = await new Promise((resolve)=>{
                reject(123);
            });

            // throw new Error('哈哈')

            console.log(2,result)

            // return Promise.reject();
        }

        console.log(3)
        var b=a();
        console.log(4,b)


        // .then版本
        // function a(){
        //     console.log(1)
        //     // const result = await 100;

        //     return new Promise((resolve)=>{
        //         resolve(123);
        //     })
        //     .then((result)=>{
        //         console.log(2,result)
        //         return 1;
        //     })
        // }
        // console.log(3)
        // a();
        // console.log(4)
    </script>
</body>
</html>